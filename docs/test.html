<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="pace.css">
    <script type="text/javascript" src='pace.min.js'></script>
    <meta charset="utf-8">
    <title>続・レターパックプラスラヴェルメイカー</title>
    <script type="text/javascript" src="./scripts/imagedata_plus.js"></script>
    <script type="text/javascript" src="./scripts/imagedata_light.js"></script>
    <script type="text/javascript" src='./scripts/mplus-2m-regular.js'></script>
    <script type="text/javascript" src="./scripts/pdfmake.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/styles2.css">
</head>
<body>
<div id="spin"></div>
<div id="base_div">
    <img id="base_img" src="imgs/plus_base.png">
    <div id="head1">
        <a id="head_title" href="http://www.post.japanpost.jp/service/letterpack/" target="_blank">
            続・レターパックプラスラヴェルメイカー
        <a>
    </div>
    <button id="reverse_btn" class="h_btn" title="ToとFromを入れ替え">Reverse</button>
    <button id="clear_to_btn" class="h_btn" title="お届け先削除">Clear To</button>
    <button id="clear_all" class="h_btn" title="全削除">Clear All</button>
    <button id="blogger" class="h_btn" title="コメントなど">Blogger</button>
    <button id="donate" class="h_btn" title="よろしければご寄付をお願いします。15円~">Donate</button>

    <input type="text" name="to_zip" id="to_zip" placeholder="郵便番号" title="半角数字7桁" autofocus>

    <div id="foot1">
        <button id="save_btn" class="f_btn" title="入力内容をファイルに保存">Save</button>
        <button id="make_btn" class="f_btn" title="pdf作成">Make PDF</button>
        <button id="load_btn" class="f_btn" title="jsonファイルから読み込み">Load</button>
    </div>
</div>
</body>
    <script type="text/javascript">
        document.getElementById('blogger').addEventListener(
            'click', function () {
                open('http://satuptown.blogspot.com/2018/09/blog-post.html');
            }, false
        );
        document.getElementById('donate').addEventListener(
            'click', function () {
                open('https://hamada2029.github.io/letterpack_label/donation.html');
            }, false
        );

        function xxx(){

            function getImagedata () {
                if (location.search == '?light') {
                    return imagedata_light;
                }
                return imagedata_plus;
            }
            pdfMake.fonts = {
                // RictyDiminishedDiscord: {
                //     normal: 'RictyDiminishedDiscord-Regular.ttf',
                // }
                mplus_2m: {
                    normal: 'mplus-2m-regular.ttf',
                }
            };
            var dd = {
                    pageSize: 'A4',
                    defaultStyle: {
                        // font: 'RictyDiminishedDiscord'
                        font: 'mplus_2m'
                    },
                    content: [
                        {
                            image: getImagedata(),
                            absolutePosition: {x:0, y:0},
                            width: 594.35
                        }
                    ]
            };
            var pdfDocGenerator = pdfMake.createPdf(dd);
            
            pdfDocGenerator.getBlob(function (result) {
                
                var urlCreator = window.URL || window.webkitURL;
                var pdfUrl = urlCreator.createObjectURL(result);
                alert(pdfUrl);
            });
        }
        document.getElementById('make_btn').addEventListener(
            'click', xxx, false
        );

        // Pace.restart();
        // urlクエリで住所渡してpdf生成したらどう？
        //sessionStorageは？


        // function setIframe () {
        //     Pace.restart();
        //     setTimeout(
        //         function () {
        //             var ifr = document.createElement('iframe');
        //             document.body.appendChild(ifr);
        //             ifr.src = './scripts/imagedata_plus.js';
        //         }, 5000
        //     );

        // }
        // document.getElementById('make_btn').addEventListener(
        //     'click', setIframe, false
        // );
        
    </script>
</html>



